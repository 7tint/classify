<%- include('../partials/header'); -%>
  <link rel="stylesheet" href="/css/bootstrap-multiselect.css">
  <script src="/js/bootstrap-multiselect.js"></script>

  <style>
    .btn-group, .btn-group-vertical {
      flex-direction: column;
      align-items: flex-start;
    }

    .dropdown-menu {
      position: relative !important;
      transform: none !important;
      margin-top: 5px;
      max-height: 200px;
      overflow-y: scroll;
      width: 350px;
    }

    .multiselect-container .input-group {
      margin: 0px;
      padding: 1rem;
    }

    .multiselect-container>li>a>label {
      padding-left: 0.75rem;
      padding-right: 0.75rem;
      padding-top: 0.15rem;
      padding-bottom: 0.15rem;
    }

    .multiselect-filter {
      display: flex;
      flex-direction: row;
      width: 100%;
    }

    .input-group-addon {
      width: 25px;
    }

    .multiselect-search {
      width: 75px !important;
      margin-right: 1rem;
      margin-left: 0.25rem;
    }
  </style>

  <div class="m-5">
    Departments Page <br/>
    <a href="/">Home</a> <br/>
    <a href="/departments">Departments</a> <br/>
    <a href="/admin">Admin</a>

    <form action="/departments/<%= department.name %>?_method=PUT" method="POST">
      <h5 class="mb-3">Edit Department</h5>
      <div class="form-row">
        <div class="col">
          <div class="form-group">
            <label for="name">Department Name</label>
            <input type="text" class="form-control" name="departmentName" id="name" placeholder="Department Name" value="<%= department.name %>" required>
          </div>
        </div>
      </div>
      <div class="form-group">
        <label for="description">Department Description</label>
        <textarea class="form-control" name="departmentDescription" id="description" rows="3"><%= department.description %> </textarea>
      </div>
      <script type="text/javascript">
        $(document).ready(function() {
            $('#courses').multiselect({
                enableFiltering: true,
                filterBehavior: 'value',
                enableCaseInsensitiveFiltering: true
            });
            $('#teachers').multiselect({
                enableFiltering: true,
                filterBehavior: 'value',
                enableCaseInsensitiveFiltering: true
            });
        });
      </script>
      <div class="mt-2 mb-4">
        <label for="courses">Department Courses</label> <br/>
        <select class="mb-3" id="courses" multiple="multiple" name="departmentCourses[]">
          <% for (let course of courses) { %>
            <% if (department.courses.includes(course.code)) { %> 
            <option value="<%= course.code %>" selected><%= course.code %></option>
            <% } else { %> 
            <option value="<%= course.code %>"><%= course.code %></option>
            <% } %> 
          <% } %>
        </select>
      </div>
      <div class="mt-2 mb-4">
        <label for="teachers">Department Teachers</label> <br/>
        <select class="mb-3" id="teachers" multiple="multiple" name="departmentTeachers[]">
          <% for (let teacher of teachers) { %>
            <% if (department.teachers.includes(`${teacher.name.firstName} ${teacher.name.lastName}`)) { %> 
            <option value="<%= teacher.name.firstName %> <%= teacher.name.lastName %>" selected><%= teacher.name.firstName %> <%= teacher.name.lastName %></option>
            <% } else { %> 
            <option value="<%= teacher.name.firstName %> <%= teacher.name.lastName %>"><%= teacher.name.firstName %> <%= teacher.name.lastName %></option>
            <% } %> 
          <% } %>
        </select>
      </div>
      <button type="submit" class="btn btn-primary">Edit Department</button>
    </form>
  </div>

<%- include('../partials/footer'); -%>
