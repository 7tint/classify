<%- include('../partials/header'); -%>
  <link rel="stylesheet" href="/css/department-course.css">
  <script src="/modules/@shopify/draggable/lib/draggable.bundle.js"></script>
  <script src="/modules/vue/dist/vue.min.js"></script>

  <a href="/classify-courses/teacher">Add Teacher to Course</a>
  
  <div id="app">
  	<div class="grid flex-start-content department-courses">
      <% departments.forEach(function(department) { %>
        <div>
          <p>Department: <%= department.name %> </p>
      		<div
      		name="sortableCards"
      		class="
      			grid
      			flex-start-content
      			disable-marker
      			cards clickable
      			sortable-animation
      		"
          style="min-height: 500px;"
      		sortable>
            <% department.courses.forEach(function(course){ %>
        			<div sortItem>
        				<p> <%= course %> </p>
        			</div>
            <% }); %>
      		</div>
        </div>

      <% }); %>
  	</div>
  </div>

  <script>
    var departmentsObj = {
      "all": []
    };

    var data = {
      departments: departmentsObj
    };

    courses = <%- JSON.stringify(courses) %>;
    departments = <%- JSON.stringify(departments) %>;

    courses.forEach(function(course, index) {
      let courseInfo = {
        course: course.code,
        color: "#ef9a9a"
      };
      departmentsObj.all.push(courseInfo);
    });

    departments.forEach(function(department, index) {
      let departmentInfo = {
        [department.name]: []
      }

      Object.assign(departmentsObj, departmentInfo);
    });

    const swappable = new Draggable.Swappable(
    	document.querySelectorAll('[swappable]'), {
    		draggable: '[swapItem]',
    		delay: 0,
    	}
    );

    const sortable = new Draggable.Sortable(
    	document.querySelectorAll('[sortable]'), {
    		draggable: '[sortItem]',
    		delay: 0,
    	}
    );
  </script>

<%- include('../partials/footer'); -%>
